---
title: ""
author: ""
date: ""
output: 
  html_document:
    toc: yes
    toc_float: yes
    toc_depth: 6
    css: "styles.css"
---
:::{#header}
<img src="logo_liggande_platta_farg.png" height="50" width="100" margin="0 auto"/>
:::

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# lista_figurer=list()
# # Om man vill uppdatera figurerna sätter man skapa_lista till TRUE. Skapa_fil styr om man vill skapa en png-fil, vilket normalt sett är fallet. Notera att skapa_lista bara skall användas när figurer behöver uppdateras. Tar betydligt mycket längre tid.
# 
# skapa_lista=FALSE
# Skapa_fil=FALSE
# i=1
# 
# #test_lank<-here("Diagram","befolkningsforandring_20_64.png")
# 
# if(skapa_lista==TRUE){
# source(here("master_kompetens.R"), encoding = "utf-8", echo = FALSE)
# lista_figurer=c(lista_figurer,hamta_figurer(skapa_fil=Skapa_fil))
#}
# Nödvändiga paket
if (!require("pacman")) install.packages("pacman")
p_load(here,
       tidyverse,
       openxlsx)

# Funktioner som behövs (hämtas från Git-Hub)
source("https://raw.githubusercontent.com/FaluPeppe/func/main/func_SkapaDiagram.R")
source("https://raw.githubusercontent.com/FaluPeppe/func/main/func_API.R")

befolkning_forandring_df <- read.xlsx("G:/skript/projekt/data/kompetensforsorjning/befolkning_prognos.xlsx")
sysselsatta_90_df <- read.xlsx("G:/skript/projekt/data/kompetensforsorjning/forvarvsarbetande_90.xlsx")
utbildning_85_df <- read.xlsx("G:/skript/projekt/data/kompetensforsorjning/utbildningsniva_85.xlsx")
utbildning_senastear_df <- read.xlsx("G:/skript/projekt/data/kompetensforsorjning/utbildningsniva_senastear.xlsx")
arbetslosa_08_df <- read.xlsx("G:/skript/projekt/data/kompetensforsorjning/arbetslöshet_08_senastear_bearbetad.xlsx")
forvarvsarbetande_bransch <- read.xlsx("G:/skript/projekt/data/kompetensforsorjning/forvarvsarbetande_bransch.xlsx")
forvarvsarbetande_prognos <- read.xlsx("G:/skript/projekt/data/kompetensforsorjning/forvarvsarbetande_prognos.xlsx")
kompetens_yrke_lan <- read.xlsx("G:/skript/projekt/data/kompetensforsorjning/kompetens_lan_bransch.xlsx")
#Skriptet som skapar nedanstående data finns på Mona: P1079gem/Jon/kompetensförsörjning/utbildningsniva_bransch_korrekt.R. OBS! Uppdateras inte när skriptet hämta data körs.
bransch_utb_alder_df <- read.xlsx("G:/skript/projekt/data/kompetensforsorjning/11_jul_23_utdata_forvarvsarbetande_bransch.xlsx")
befolkning_flytt_df <- read.xlsx("G:/skript/projekt/data/kompetensforsorjning/befolkningsforandring_20_64.xlsx")
befolkning_utr_inr_df <- read.xlsx("G:/skript/projekt/data/kompetensforsorjning/befolkning_utr_inr.xlsx")
pendling_lan_df <- read.xlsx("G:/skript/projekt/data/kompetensforsorjning/pendling_lan.xlsx")
pendling_kommun_df <- read.xlsx("G:/skript/projekt/data/kompetensforsorjning/pendling_kommun.xlsx")
#Skriptet som skapar nedanstående data finns på Mona: P1079gem/Jon/kompetensförsörjning/utbildningsniva_befolkning_bakgrund_korrekt.R. OBS! Uppdateras inte när skriptet hämta data körs.
befolkning_utb_alder_df <- read.xlsx("G:/skript/projekt/data/kompetensforsorjning/12_jul_23_utdata_utbildningsniva_befolkning_bakgrund.xlsx")
```
# Kompetensförsörjning i Dalarna
<p style = "font-size:12px">
<i>Skapad av: Samhällsanalys, Region Dalarna<br>
Senast uppdaterad: `r Sys.Date()`</i>
</p>


## 2 Bakgrund och teori

```{r, echo=FALSE, message = FALSE, warning = FALSE,include=FALSE}

diagram_capt <- "Källa: SCB:s öppna statistikdatabas\nBearbetning: Samhällsanalys, Region Dalarna\nDiagramförklaring: 2031 är prognos, övriga historisk data."
 # Det första datasettet - innehåller åldersgrupper men inte totalt för alla
 
# Summerar på år och aldersgrupper
 befolkning_forandring_df_sum <- befolkning_forandring_df %>%
   group_by(år,aldersgrupper) %>%
    summarize(`Folkmängd`=sum(`Folkmängd`))

 # Använder en faktorvariabel för att styra ordningen på åldersgrupper
 befolkning_forandring_df_sum$aldersgrupper <- factor(befolkning_forandring_df_sum$aldersgrupper, levels = c("totalt","0-19 år","20-64 år","65-79 år","80+ år"))
 
   diagram_titel <- "Dalarnas befolkning uppdelat på åldersgrupper"
   diagram_typ <- "befolkning_forandring"
   diagramfil <- "befolkning_forandring.png"

   befolkning_for <- SkapaStapelDiagram(skickad_df = befolkning_forandring_df_sum %>%
                                          filter(aldersgrupper!="totalt"),
                                        skickad_x_var = "aldersgrupper",
                                        skickad_y_var = "Folkmängd",
                                        skickad_x_grupp = "år",
                                        manual_x_axis_text_vjust=0.7,
                                        manual_x_axis_text_hjust=0.3,
                                        manual_color = diagramfarger("rus_sex"),
                                        x_axis_lutning = 0,
                                        diagram_titel = diagram_titel,
                                        diagram_capt = diagram_capt,
                                        manual_x_axis_title = "Åldersgrupper",
                                        stodlinjer_avrunda_fem = TRUE,
                                        output_mapp = "",
                                        filnamn_diagram = diagramfil,
                                        skriv_till_diagramfil =FALSE)

```

```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 1"}
   befolkning_for
```

```{r, echo=FALSE, message = FALSE, warning = FALSE, include=FALSE}
diagram_capt <- "Källa: RAMS i SCB:s öppna statistikdatabas\nBearbetning: Samhällsanalys, Region Dalarna\nDiagramförklaring: Branschgruppering baserad på SNI2002 och SNI92"

# Gör om år till en faktorvariabel för utbildningsnivå_balans. Detta för att kunna bestämma vilken ordning staplarna för de olika åren kommer i diagrammet
max_ar <- max(sysselsatta_90_df$år)

#sysselsatta_90_df$år <- factor(sysselsatta_90_df$år, levels = c(max_ar,"2010","2000","1990"))

sysselsatta_90_df$Näringsgren <- stringr::str_to_sentence(sysselsatta_90_df$Näringsgren)

sysselsatta_90_df$Näringsgren <- str_wrap(sysselsatta_90_df$Näringsgren,40)

diagram_titel <- paste0("Förvärvsarbetande (16+ år) i Dalarna ")
diagramfil <- "per_bransch_tidsserie.png"

fig_forv_90 <- SkapaStapelDiagram(skickad_df = sysselsatta_90_df %>%
                                   filter(år%in%c("1990","2000","2010",max_ar)),
                                 skickad_x_var = "Näringsgren",
                                 skickad_y_var = "antal",
                                 skickad_x_grupp = "år",
                                 manual_x_axis_text_vjust=1,
                                 manual_x_axis_text_hjust=1,
                                 manual_color = diagramfarger("rus_sex"),
                                 x_axis_sort_value = TRUE,
                                 vand_sortering = TRUE,
                                 stodlinjer_avrunda_fem = TRUE,
                                 x_axis_sort_grp = 4,
                                 x_axis_lutning = 45,
                                 diagram_titel = diagram_titel,
                                 diagram_capt = diagram_capt,
                                 manual_y_axis_title = "",
                                 output_mapp = "",
                                 filnamn_diagram = diagramfil,
                                 skriv_till_diagramfil = FALSE)

knitr::include_graphics(here("Diagram","per_bransch_tidsserie.png"))
```

```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 2"}
fig_forv_90
```
<br>
<br>
<br>
```{r, echo=FALSE, message = FALSE, warning = FALSE, fig.width=10, fig.align='Center',fig.cap="Figur 3"}
knitr::include_graphics("G:/Samhällsanalys/Projekt och uppdrag/Kompetensförsörjning/Branschindelning/Visualisering/Dagbefolkning/2020/Branschstruktur_Dalarnas_kommuner_2020.png")
```
<br>
<br>
<br>
```{r, echo=FALSE,message = FALSE, warning = FALSE, fig.width=10, fig.align='Center',fig.cap="Figur 3"}
knitr::include_graphics("G:/Samhällsanalys/Projekt och uppdrag/Kompetensförsörjning/Branschindelning/Visualisering/Dagbefolkning/2020/Dalarna_kon_dagbef_2020.png")
```
<br>
<br>
<br>
```{r, echo=FALSE, message = FALSE, warning = FALSE}
diagram_capt <- "Källa: SCB:s öppna statistikdatabas.\nBearbetning: Samhällsanalys, Region Dalarna."

# Tar bort uppgift saknas och beräknar hur stor andel som har en viss utbildning
utbildning_85_utskrift<-utbildning_85_df %>%
  filter(utb_niva!="Uppgift saknas") %>%
    group_by(år,region,kön,utb_niva) %>%
      summarize(antal=sum(Befolkning)) %>%
        mutate(andel=(antal/sum(antal))*100)

diagramtitel <- paste0("Andel av befolkningen (25-64 år) med minst 3 års eftergymnasial utbildning i ",unique(utbildning_85_utskrift$region))
diagramtitel <- str_wrap(diagramtitel)
diagramfilnamn <- paste0("utbildningsniva_85_21_kon.png")

utb_85_fig <- SkapaStapelDiagram(skickad_df =utbildning_85_utskrift %>%
                              filter(år%in%c("1985","1990","1995","2000","2005","2010","2015",max(utbildning_85_utskrift$år))) %>%
                                filter(utb_niva=="Eftergymnasial utbildning, 3 år eller mer"),
                             skickad_x_var = "år",
                             skickad_y_var = "andel",
                             skickad_x_grupp = "kön",
                             manual_color = diagramfarger("kon"),
                             diagram_titel = diagramtitel,
                             diagram_capt =  diagram_capt,
                             x_axis_lutning = 0,
                             stodlinjer_avrunda_fem = TRUE,
                             manual_y_axis_title="procent",
                             output_mapp = "",
                             filnamn_diagram = diagramfilnamn,
                             skriv_till_diagramfil = FALSE)
```

```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 6"}
utb_85_fig
```

```{r, echo=FALSE, message = FALSE, warning = FALSE}
# Ta bort s och län i länsnamn
utbildning_senastear_df$region <- skapa_kortnamn_lan(utbildning_senastear_df$region,byt_ut_riket_mot_sverige = TRUE)

# Tar bort uppgift saknas och beräknar hur stor andel som har en viss utbildning - ej uppdelat på kön
utbildning_senastear_df <- utbildning_senastear_df %>%
  filter(utb_niva!="Uppgift saknas") %>%
    group_by(år,region,utb_niva) %>%
      summarize(antal = sum(Befolkning)) %>%
        mutate(andel = (antal/sum(antal))*100)

diagramtitel <- paste0("Andel av befolkningen (25-64 år) med minst 3 års eftergymnasial utbildning ",max(utbildning_senastear_df$år))
diagramtitel <- str_wrap(diagramtitel)
diagramfilnamn <- paste0("utbildningsniva_jmf_lan.png")

utb_senastear_fig <- SkapaStapelDiagram(skickad_df = utbildning_senastear_df %>%
                                         filter(år == max(år),utb_niva == "Eftergymnasial utbildning, 3 år eller mer") %>% 
                                          mutate(fokus = ifelse(region == "Dalarna",1,
                                                                 ifelse(region == "Sverige",2,0))),
                                       skickad_x_var = "region",
                                       skickad_y_var = "andel",
                                       manual_x_axis_text_vjust=1,
                                       manual_x_axis_text_hjust=1,
                                       manual_color = diagramfarger("rus_tre_fokus"),
                                       diagram_titel = diagramtitel,
                                       diagram_capt =  diagram_capt,
                                       x_axis_sort_value = TRUE,
                                       x_axis_lutning = 45,
                                       x_var_fokus = "fokus",
                                       stodlinjer_avrunda_fem = TRUE,
                                       manual_y_axis_title = "procent",
                                       output_mapp = "",
                                       filnamn_diagram = diagramfilnamn,
                                       skriv_till_diagramfil = FALSE)

```

```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 7"}
utb_senastear_fig
```

```{r, echo=FALSE, message = FALSE, warning = FALSE}
diagram_capt <- "Källa: Arbetsförmedlingen.\nBearbetning: Samhällsanalys, Region Dalarna.\nDiagramförklaring: Månadsdata. Diagrammet visar medelvärdet för året"

diagramtitel <- paste0("Arbetslöshet i Dalarna och Sverige")
diagramfilnamn <- paste0("arbetsloshet_08_senastear.png")

arb_08_fig <- SkapaStapelDiagram(skickad_df =arbetslosa_08_df ,
                                 skickad_x_var = "Ar",
                                 skickad_y_var = "Arbetslöshet",
                                 skickad_x_grupp = "Region",
                                 manual_x_axis_text_vjust=1,
                                 manual_x_axis_text_hjust=1,
                                 manual_color = diagramfarger("rus_sex"),
                                 diagram_titel = diagramtitel,
                                 diagram_capt =  diagram_capt,
                                 x_axis_lutning = 45,
                                 manual_y_axis_title = "procent",
                                 stodlinjer_avrunda_fem = TRUE,
                                 output_mapp = "",
                                 filnamn_diagram = diagramfilnamn,
                                 skriv_till_diagramfil = FALSE)
```

```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 7"}
arb_08_fig
```

## 3 Efterfrågan, nu och framledes
### Förvärvsarbetande
```{r, echo=FALSE, message = FALSE, warning = FALSE}
diagram_capt <- "Källa: SCB:s öppna statistikdatabas.\nBearbetning: Samhällsanalys, Region Dalarna.\nDiagramförklaring: 16-74 år"

forvarvsarbetande_bransch$andel <- (forvarvsarbetande_bransch$andel)*100

diagramtitel <- paste0("Antal förvärvsarbetande per bransch i Dalarna år ",unique(forvarvsarbetande_bransch$år))
diagramfil <- "forvarvsarbetande_bransch.png"

forvarvsarbetande_kon_fig <- SkapaStapelDiagram(skickad_df <- forvarvsarbetande_bransch %>%
                                                 filter(region == "Dalarna"), 
                                               skickad_x_var = "naringsgren", 
                                               skickad_y_var = "antal", 
                                               skickad_x_grupp = "kön",
                                               diagram_liggande=FALSE,
                                               manual_x_axis_text_vjust=1,
                                               manual_x_axis_text_hjust=1,
                                               x_axis_lutning = 45,
                                               x_axis_sort_value=TRUE,
                                               manual_color = diagramfarger("kon"),
                                               stodlinjer_avrunda_fem = TRUE,
                                               diagram_titel = diagramtitel,
                                               diagram_capt =  diagram_capt,
                                               facet_legend_bottom=TRUE,
                                               berakna_index = FALSE,
                                               output_mapp = "",
                                               filnamn_diagram = diagramfil,
                                               skriv_till_diagramfil = FALSE)
```

```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 7"}
forvarvsarbetande_kon_fig
```

```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 9", include = FALSE}
#lista_figurer$antal_sysselsatta_proc_min_max_ar
knitr::include_graphics(here("Diagram","antal_sysselsatta_proc_min_max_ar.png"))
```

```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 9", include = FALSE}
#lista_figurer$antal_sysselsatta_proc_min_max_ar
knitr::include_graphics(here("Diagram","antal_sysselsatta_proc_min_max_ar_ejsun.png"))
```

```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 10",include = FALSE}
#lista_figurer$antal_sysselsatta_proc_min_max_ar
knitr::include_graphics(here("Diagram","antal_forvarvsarbetande_bransch_97.png"))
```

```{r, echo=FALSE, message = FALSE, warning = FALSE}
diagram_capt <- "Källa: RAMS i SCB:s öppna statistikdatabas\nBearbetning: Samhällsanalys, Region Dalarna\nDiagramförklaring: Branschgruppering baserad på SNI2002 och SNI92"

# Beräknar förändring in antalet anställda från 1990 till senaste år
sysselsatta_df_forandring <- sysselsatta_90_df %>% 
  filter(år %in% c(min(år),max(år))) %>% 
    group_by(region,Näringsgren) %>% 
      mutate(skillnad = last(antal)-first(antal))  
        
diagram_titel <- paste0("Förändring av antalet förvärvsarbetande (16-74) år från år ", min(sysselsatta_df_forandring$år), " till ", max(sysselsatta_df_forandring$år))
diagramfil <- "forvarvsarbetande_forandring.png"

forv_forandring_fig <- SkapaStapelDiagram(skickad_df = sysselsatta_df_forandring %>% 
                                           filter(år == max(år),Näringsgren != "näringsgren okänd"), 
                                         skickad_x_var = "Näringsgren", 
                                         skickad_y_var = "skillnad",
                                         manual_color = diagramfarger("rus_sex")[1],
                                         diagram_titel = diagram_titel,
                                         x_axis_sort_value = TRUE,
                                         x_axis_lutning = 90,
                                         diagram_capt = diagram_capt,
                                         diagram_liggande = TRUE,
                                         diagram_facet = FALSE,
                                         stodlinjer_avrunda_fem = TRUE,
                                         geom_position_stack = TRUE,
                                         berakna_index = FALSE,
                                         output_mapp = "",
                                         filnamn_diagram = diagramfil,
                                         skriv_till_diagramfil = FALSE)

```

```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 7"}
forv_forandring_fig
```

```{r, echo=FALSE, message = FALSE, warning = FALSE}
diagram_capt <- "Källa: Regionala utbildnings och arbetsmarknadsprognoser, SCB\nBearbetning: Samhällsanalys, Region Dalarna"

diagram_titel <- "Prognos för antalet förvärvsarbetande 16-74 år per bransch i Dalarnas län"
diagramfil <- "forvarvsarbetande_prognos.png"

forvarvsarbetande_prognos_fig <- SkapaStapelDiagram(skickad_df = forvarvsarbetande_prognos %>%
                                                     filter(Ar%in%c("2018","2025","2035"),SNI2007_Grupp_namn!="Okänt"),
                                                   skickad_x_var = "SNI2007_Grupp_namn",
                                                   skickad_y_var = "sysselsatta",
                                                   skickad_x_grupp = "Ar",
                                                   manual_x_axis_text_vjust=1,
                                                   manual_x_axis_text_hjust=1,
                                                   manual_color = diagramfarger("rus_sex"),
                                                   diagram_titel = diagram_titel,
                                                   diagram_capt = diagram_capt,
                                                   x_axis_lutning = 45,
                                                   x_axis_sort_value = TRUE,
                                                   legend_vand_ordning = FALSE,
                                                   stodlinjer_avrunda_fem = TRUE,
                                                   diagram_liggande = FALSE,
                                                   berakna_index = FALSE,
                                                   output_mapp = "",
                                                   filnamn_diagram = diagramfil,
                                                   skriv_till_diagramfil = FALSE)

```

```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 7"}
forvarvsarbetande_prognos_fig
```

### Kompetenskrav

```{r, echo=FALSE, message = FALSE, warning = FALSE}
diagram_capt <- "Källa: Yrkesregistret i SCB:s öppna statistikdatabas\nBearbetning: Samhällsanalys, Region Dalarna"

kompetens_lan <- kompetens_yrke_lan %>%
    filter(år == max(år)) %>% 
    group_by(år,region,kompetensniva) %>%
      summarize(Antal=sum(`Anställda.16-64.år.(dagbef)`)) %>%
        mutate(Andel=(Antal/sum(Antal))*100)

# Skapar en faktorvariabel för att få utbildningsnivå i "rätt" ordning i figuren
kompetens_lan$kompetensniva <- factor(kompetens_lan$kompetensniva, levels = c("Enklare yrken","Motsvarande gymnasial kompetens","Motsvarande högskolekompetens","Motsvarande fördjupad högskolekompetens","Chefsyrken","Okänt")[6:1])

diagram_titel <- paste0("Kvalifikationskrav för anställda (16-64 år) ",max(kompetens_lan$år))
diagramfil <- "kompetenskrav_lan.png"

kompetens_lan_fig <- SkapaStapelDiagram(skickad_df = kompetens_lan %>% 
                                          mutate(region = skapa_kortnamn_lan(region)),
                                         skickad_x_var = "region",
                                         skickad_y_var = "Andel",
                                         skickad_x_grupp = "kompetensniva",
                                         manual_color = c(rgb(211,211,211, maxColorValue = 255),diagramfarger("rus_sex")),
                                         diagram_titel = diagram_titel,
                                         x_axis_lutning = 0,
                                         diagram_capt = diagram_capt,
                                         legend_vand_ordning = TRUE,
                                         diagram_liggande = TRUE,
                                         geom_position_stack = TRUE,
                                         manual_y_axis_title = "procent",
                                         stodlinjer_avrunda_fem = TRUE,
                                         x_axis_sort_value = TRUE,
                                         x_axis_sort_grp = 6,
                                         vand_sortering = TRUE,
                                         output_mapp = "",
                                         filnamn_diagram = diagramfil,
                                         skriv_till_diagramfil = FALSE)
  

```

```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 7"}
kompetens_lan_fig
```

```{r, echo=FALSE, message = FALSE, warning = FALSE}
diagram_capt <- "Källa: Yrkesregistret i SCB:s öppna statistikdatabas\nBearbetning: Samhällsanalys, Region Dalarna"

kompetens_bransch <- kompetens_yrke_lan %>%
  filter(år==max(år),region=="Dalarnas län") %>%
    group_by(region,år,Branschgrupp,kompetensniva) %>%
      summarize(Antal=sum(`Anställda.16-64.år.(dagbef)`)) %>%
        mutate(Andel=((Antal/sum(Antal))*100)-0.001)
  
# Skapar en faktorvariabel för att få utbildningsnivå i "rätt" ordning i figuren
kompetens_bransch$kompetensniva <- factor(kompetens_bransch$kompetensniva, levels = c("Enklare yrken","Motsvarande gymnasial kompetens","Motsvarande högskolekompetens","Motsvarande fördjupad högskolekompetens","Chefsyrken","Okänt")[6:1])

diagram_titel <- paste0("Kvalifikationskrav för anställda (16-64 år) i ",unique(kompetens_bransch$region)," ",unique(kompetens_bransch$år))
diagramfil <- "kompetenskrav_bransch.png"

kompetens_bransch_fig <- SkapaStapelDiagram(skickad_df = kompetens_bransch %>% 
                                         filter(Branschgrupp != "Okänd verksamhet"), 
                                           skickad_x_var = "Branschgrupp",
                                           skickad_y_var = "Andel",
                                           skickad_x_grupp = "kompetensniva",
                                           manual_color = c(rgb(211,211,211, maxColorValue = 255),diagramfarger("rus_sex")),
                                           diagram_titel = diagram_titel,
                                           #x_axis_sort_value = TRUE,
                                           legend_vand_ordning = TRUE,
                                           diagram_capt = diagram_capt,
                                           x_axis_lutning = 0,
                                           diagram_liggande = TRUE,
                                           x_axis_sort_value = TRUE,
                                           x_axis_sort_grp = 6,
                                           vand_sortering = TRUE,
                                           geom_position_stack = TRUE,
                                           manual_y_axis_title = "procent",
                                           stodlinjer_avrunda_fem = TRUE,
                                           output_mapp = "",
                                           filnamn_diagram = diagramfil,
                                           skriv_till_diagramfil = FALSE)
```

```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 7"}
kompetens_bransch_fig
```

### Utbildning och ålder

```{r, echo=FALSE, message = FALSE, warning = FALSE}
diagram_capt <- "Källa: NMS-databasen (SCB), databasen Stativ\nBearbetning: Samhällsanalys, Region Dalarna"

diagram_titel <- paste0("Utbildningsnivå för förvärvsarbetande 16-74 år per bransch i Dalarnas län ",unique(bransch_utb_alder_df$year))
diagramfil <-  "utbildningsniva_bransch.png"

bransch_utb_alder_df[bransch_utb_alder_df == "Eftergymnasial utbildning"]<-"eftergymnasial"
bransch_utb_alder_df[bransch_utb_alder_df == "Förgymnasial utbildning"]<-"förgymnasial"
bransch_utb_alder_df[bransch_utb_alder_df == "grundskola"]<-"förgymnasial"
bransch_utb_alder_df[bransch_utb_alder_df == "Gymnasial utbildning"]<-"gymnasial"
bransch_utb_alder_df[bransch_utb_alder_df == "Uppgift saknas"]<-"Okänd"
  
# Grupperar på år, län, bransch och utbildning - används i diagram 1.
#  Drar bort en obefintlig summa för att diagrammet skall gå till 100.
bransch_utb_df_sum <- bransch_utb_alder_df %>%
  group_by(year,AstLan_namn,SNI2007_Grupp_namn,Sun2020Niva_grov_namn) %>% 
    summarize(Antal=sum(antal)) %>% 
      mutate(Andel=(Antal/sum(Antal)*100)-0.001)

# Skapar en faktorvariabel för att få utbildningsnivå i "rätt" ordning i figuren
bransch_utb_df_sum$Sun2020Niva_grov_namn <- factor(bransch_utb_df_sum$Sun2020Niva_grov_namn, levels = c("Okänd","eftergymnasial","gymnasial","förgymnasial"))

# Skapar en separat färgkod, så att okänd blir ljusgrå
farger_gra<-c(rgb(211,211,211, maxColorValue = 255),diagramfarger("rus_sex"))

bransch_utb_fig <- SkapaStapelDiagram(skickad_df = bransch_utb_df_sum %>% 
                                            filter(SNI2007_Grupp_namn!="Okänt"), 
                             skickad_x_var = "SNI2007_Grupp_namn", 
                             skickad_y_var = "Andel", 
                             skickad_x_grupp = "Sun2020Niva_grov_namn",
                             manual_color = farger_gra,
                             x_axis_lutning = 0,
                             diagram_titel = diagram_titel,
                             x_axis_sort_value = TRUE,
                             x_axis_sort_grp = 4,
                             diagram_capt = diagram_capt,
                             #procent_0_100_10intervaller = TRUE,
                             stodlinjer_avrunda_fem = TRUE,
                             legend_vand_ordning = TRUE,
                             diagram_liggande = TRUE,
                             geom_position_stack = TRUE,
                             manual_y_axis_title = "procent",
                             output_mapp = "",
                             filnamn_diagram = diagramfil,
                             skriv_till_diagramfil = FALSE)

```

```{r, echo=FALSE, fig.width=10,fig.align='Left',fig.cap="Figur 14"}
bransch_utb_fig
```

```{r, echo=FALSE, message = FALSE, warning = FALSE}
# Grupperar på år, län, bransch och utbildning - används i diagram 1.
#  Drar bort en obefintlig summa för att diagrammet skall gå till 100.
bransch_alder_df_sum <- bransch_utb_alder_df %>%
  group_by(year,AstLan_namn,SNI2007_Grupp_namn,alder_grupper) %>% 
    summarize(Antal=sum(antal)) %>% 
      mutate(Andel=(Antal/sum(Antal)*100)-0.001)

#utbildning_df_alder_sum$alder_grupper <- factor(utbildning_df_alder_sum$alder_grupper, levels = c("50-64 år","35-49 år","20-34 år"))
bransch_alder_df_sum$alder_grupper <- factor(bransch_alder_df_sum$alder_grupper, levels = c("71-74 år","65-70 år","50-64 år","35-49 år","20-34 år","16-19 år"))

diagram_titel <- paste0("Åldersfördelning för förvärvsarbetande 16-74 år per bransch i Dalarnas län ",unique(bransch_alder_df_sum$year))
diagramfil <- "aldersniva_bransch_andel.png"
    
bransch_alder_fig <- SkapaStapelDiagram(skickad_df = bransch_alder_df_sum %>% 
                                           filter(SNI2007_Grupp_namn!="Okänt"), 
                                       skickad_x_var = "SNI2007_Grupp_namn", 
                                       skickad_y_var = "Andel", 
                                       skickad_x_grupp = "alder_grupper",
                                       manual_x_axis_text_vjust=1,
                                       manual_x_axis_text_hjust=1,
                                       manual_color = diagramfarger("rus_sex"),
                                       diagram_titel = diagram_titel,
                                       x_axis_sort_value = TRUE,
                                       x_axis_lutning = 0,
                                       x_axis_sort_grp = 6,
                                       diagram_capt = diagram_capt,
                                       stodlinjer_avrunda_fem = TRUE,
                                       diagram_liggande = TRUE,
                                       legend_vand_ordning = TRUE,
                                       geom_position_stack = TRUE,
                                       manual_y_axis_title = "procent",
                                       output_mapp = "",
                                       filnamn_diagram = diagramfil,
                                       skriv_till_diagramfil = FALSE)
```

```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 15"}
bransch_alder_fig
```

```{r, echo=FALSE, message = FALSE, warning = FALSE}
diagram_titel <- paste0("Åldersfördelning för förvärvsarbetande 16-74 år per bransch i Dalarnas län ",unique(bransch_alder_df_sum$year))
diagramfil <- "aldersniva_bransch_antal.png"

bransch_alder_antal_fig <- SkapaStapelDiagram(skickad_df = bransch_alder_df_sum %>% 
                                                 filter(SNI2007_Grupp_namn!="Okänt"), 
                                             skickad_x_var = "SNI2007_Grupp_namn", 
                                             skickad_y_var = "Antal", 
                                             skickad_x_grupp = "alder_grupper",
                                             manual_x_axis_text_vjust=1,
                                             manual_x_axis_text_hjust=1,
                                             manual_color = diagramfarger("rus_sex"),
                                             diagram_titel = diagram_titel,
                                             x_axis_sort_value = TRUE,
                                             x_axis_lutning = 45,
                                             diagram_capt = diagram_capt,
                                             diagram_liggande = FALSE,
                                             legend_vand_ordning = TRUE,
                                             geom_position_stack = TRUE,
                                             output_mapp = "",
                                             filnamn_diagram = diagramfil,
                                             skriv_till_diagramfil = FALSE)
```

```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 16"}
bransch_alder_antal_fig
```

## 4 Utbud i Dalarnas län
### Befolkning och pendling
```{r, echo=FALSE, message = FALSE, warning = FALSE}
  diagram_capt <- "Källa: Befolkningsregistret i SCB:s öppna statistikdatabas.\nBearbetning: Samhällsanalys, Region Dalarna.\nDiagramförklaring: Demografisk förändring är den del av befolkningsförändringen som inte kan förklaras av inrikes och utrikes flyttnetto."

  # Grupperar och pivoterar data
  utskrift_df <- befolkning_flytt_df %>%
    rename("Inrikes flyttnetto" = `inrikes.flyttnetto`,
           "Utrikes flyttnetto" = `utrikes.flyttnetto`,
           "Demografisk förändring" = `Demografisk.förändring` ) %>% 
      select(region,`Inrikes flyttnetto`,`Utrikes flyttnetto`,`Demografisk förändring`) %>% 
        pivot_longer(!c(region),names_to="variabel",values_to="forandring")
  
  diagramtitel <- paste0("Befolkningsförändring i arbetsför ålder (20-64 år) per län ","2010","-",unique(befolkning_flytt_df$region))
  diagramfilnamn <- paste0("befolkningsforandring_20_64.png")

  bef_for_flytt <- SkapaStapelDiagram(skickad_df =utskrift_df,
                                     skickad_x_var = "region",
                                     skickad_y_var = "forandring",
                                     skickad_x_grupp = "variabel",
                                     manual_color = diagramfarger("rus_sex"),
                                     diagram_titel = diagramtitel,
                                     diagram_capt =  diagram_capt,
                                     diagram_facet = FALSE,
                                     x_axis_lutning = 0,
                                     x_axis_sort_value = TRUE,
                                     diagram_liggande = TRUE,
                                     stodlinjer_avrunda_fem = TRUE,
                                     geom_position_stack = TRUE,
                                     manual_y_axis_title="procent",
                                     berakna_index = FALSE,
                                     output_mapp = "",
                                     filnamn_diagram = diagramfilnamn,
                                     skriv_till_diagramfil = FALSE)
  
```

```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 7"}
bef_for_flytt
```

```{r, echo=FALSE, message = FALSE, warning = FALSE}
diagram_capt <- "Källa: Befolkningsregistret i SCB:s öppna statistikdatabas.\nBearbetning: Samhällsanalys, Region Dalarna."

befolkning_utr_inr_df$bakgrund <- factor(befolkning_utr_inr_df$bakgrund, levels = c("Utrikes födda","Inrikes födda"))

diagramtitel <- paste0("Befolkning i arbetsför ålder (20-64 år) i ",unique(befolkning_utr_inr_df$region))
diagramfilnamn <- paste0("befolkning_utr_inr.png")

bef_inr_utr <- SkapaStapelDiagram(skickad_df = befolkning_utr_inr_df, 
                             skickad_x_var = "år", 
                             skickad_y_var = "antal", 
                             skickad_x_grupp = "bakgrund",
                             manual_color = diagramfarger("rus_sex"),
                             diagram_titel = diagramtitel,
                             #x_axis_sort_value = TRUE,
                             diagram_capt = diagram_capt,
                             #procent_0_100_10intervaller = TRUE,
                             x_axis_lutning = 0,
                             legend_vand_ordning = TRUE,
                             diagram_liggande = TRUE,
                             manual_y_axis_title = "",
                             geom_position_stack = TRUE,
                             stodlinjer_avrunda_fem = TRUE,
                             berakna_index = FALSE,
                             output_mapp = "",
                             filnamn_diagram = diagramfilnamn,
                             skriv_till_diagramfil = FALSE)
```

```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 18"}
bef_inr_utr
```

```{r, echo=FALSE, message = FALSE, warning = FALSE}
diagram_capt <- "Källa: SCB:s öppna statistikdatabas.\nBearbetning: Samhällsanalys, Region Dalarna.\nDiagramförklaring: Inpendling i förhållande till dagbefolkning och utpendling i förhållande till nattbefolkning (i arbetsför ålder, 20-64 år). Gäller pendlare över länsgräns."

# Skapar ett dataset som används för att skriva ut
pendling_lan_df <- pendling_lan_df %>%
  select(region,år,`Andel.inpendling`,`Andel.utpendling`) %>% 
    pivot_longer(cols=3:4,names_to = "Typ_pendling") %>% 
      mutate("Typ_pendling" = ifelse(Typ_pendling == "Andel.inpendling","Andel inpendling", "Andel utpendling"))

diagramtitel <- paste0("Andel pendling i Sveriges regioner ",unique(pendling_lan_df$år))
diagramfilnamn <- paste0("pendling_lan.png")

pendling_lan <- SkapaStapelDiagram(skickad_df =pendling_lan_df,
                                   skickad_x_var = "region",
                                   skickad_y_var = "value",
                                   skickad_x_grupp = "Typ_pendling",
                                   manual_x_axis_text_vjust=1,
                                   manual_x_axis_text_hjust=1,
                                   manual_color = diagramfarger("rus_sex"),
                                   diagram_titel = diagramtitel,
                                   diagram_capt =  diagram_capt,
                                   stodlinjer_avrunda_fem = TRUE,
                                   x_axis_sort_value = TRUE,
                                   x_axis_sort_grp = 2,
                                   vand_sortering = TRUE,
                                   manual_y_axis_title="procent",
                                   output_mapp = "",
                                   filnamn_diagram = diagramfilnamn,
                                   skriv_till_diagramfil = FALSE)

```

```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 19"}
pendling_lan
```

```{r, echo=FALSE, message = FALSE, warning = FALSE}
  diagram_capt <- "Källa: SCB (via Kolada)\nBearbetning: Samhällsanalys, Region Dalarna\nDiagramförklaring: Antal inpendlare (personer som förvärvsarbetar i kommunen/regionen och bor i en annan kommun/region)\ndividerat med antal förvärvsarbetande som arbetar i kommunen/regionen (dagbefolkning)\nAntal utpendlare (personer som bor i kommunen/regionen och förvärvsarbetar i en annan kommun/region)\ndividerat med antal förvärvsarbetande som bor i kommunen/regionen (nattbefolkning)" 

diagram_titel <- paste0("Andel av förvärvsarbetande som pendlar över kommungräns år ",max(pendling_kommun_df$year))
diagram_titel<-str_wrap(diagram_titel,50)
diagramfil <- "pendling_kommun.png"

pendling_kommun <- SkapaStapelDiagram(skickad_df = pendling_kommun_df %>%
                               filter(year%in%c(max(year))) %>%
                                filter(gender=="T") %>%
                                  mutate(municipality=ifelse(municipality=="Riket", "Sverige",municipality)),
                             skickad_x_var = "municipality",
                             skickad_y_var = "Pendling_andel",
                             skickad_x_grupp = "pendling_typ",
                             manual_x_axis_text_vjust=1,
                             manual_x_axis_text_hjust=1,
                             manual_color = diagramfarger("rus_sex"),
                             x_axis_sort_value = TRUE,
                             x_axis_sort_grp = 2,
                             vand_sortering=TRUE,
                             dataetiketter = FALSE,
                             dataetiketter_antal_dec = 0,
                             manual_y_axis_title="procent",
                             stodlinjer_avrunda_fem = TRUE,
                             diagram_titel = diagram_titel,
                             diagram_capt = diagram_capt,
                             output_mapp = "",
                             filnamn_diagram = diagramfil,
                             skriv_till_diagramfil = FALSE)

```

```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 20"}
pendling_kommun
```

### Utbildningsnivå

```{r, echo=FALSE, message = FALSE, warning = FALSE}
  diagram_capt <- "Källa: NMS-databasen (SCB), databasen Stativ\nBearbetning: Samhällsanalys, Region Dalarna"

  befolkning_utb_alder_df$SUN_old_namn <- case_when(
                                          substr(befolkning_utb_alder_df$Sun2020Niva,1,2) == "10"~"Förgymnasial utbildning kortare än 9 år",
                                          substr(befolkning_utb_alder_df$Sun2020Niva,1,2) == "20"~"Förgymnasial utbildning 9 år",
                                          substr(befolkning_utb_alder_df$Sun2020Niva,1,2) %in% as.character(31:32)~"Gymnasial utbildning högst 2-årig",
                                          substr(befolkning_utb_alder_df$Sun2020Niva,1,2) == "33"~"Gymnasial utbildning, 3 år",
                                          substr(befolkning_utb_alder_df$Sun2020Niva,1,2) %in% as.character(41:52)~"Eftergymnasial utbildning kortare än 3 år",
                                          substr(befolkning_utb_alder_df$Sun2020Niva,1,2) %in% c(as.character(53:55),as.character(60:64))~"Eftergymnasial utbildning 3 år eller längre",
                                          befolkning_utb_alder_df$Sun2020Niva == "999"~"Okänd")

  # Tittar på utbildning och bakgrund - diagram 2
 befolkning_utb_2064_df_sum <- befolkning_utb_alder_df %>%
   filter(SUN_old_namn != "Okänd") %>% 
    group_by(year,Lan_namn,Kon_namn,bakgrund,SUN_old_namn) %>% 
      summarize(antal=sum(antal)) %>%
        mutate(andel=round((antal/sum(antal))*100,2)) 

  # Skapar en faktorvariabel för att få utbildningsnivå i "rätt" ordning i figuren
  befolkning_utb_2064_df_sum$SUN_old_namn <- factor(befolkning_utb_2064_df_sum$SUN_old_namn, levels = c("Eftergymnasial utbildning 3 år eller längre","Eftergymnasial utbildning kortare än 3 år",
                                                                                                                            "Gymnasial utbildning, 3 år","Gymnasial utbildning högst 2-årig",
                                                                                                                            "Förgymnasial utbildning 9 år","Förgymnasial utbildning kortare än 9 år")[6:1])
            
  diagram_titel <- paste0("Befolkningens (20-64 år) utbildningsnivå i Dalarnas län ", unique(befolkning_utb_2064_df_sum$year))
  diagramfil <- "fodelseregion_utbildning.png"
  
  utb_bakgrund_fig <- SkapaStapelDiagram(skickad_df = befolkning_utb_2064_df_sum, 
                               skickad_x_var = "bakgrund", 
                               skickad_y_var = "andel", 
                               skickad_x_grupp = "SUN_old_namn",
                               manual_color = diagramfarger("rus_sex"),
                               diagram_titel = diagram_titel,
                               x_axis_sort_value = TRUE,
                               diagram_capt = diagram_capt,
                               dataetiketter = TRUE,
                               dataetiketter_antal_dec = 1,
                               diagram_facet = TRUE,
                               facet_legend_bottom = TRUE,
                               facet_grp = "Kon_namn",
                               stodlinjer_avrunda_fem = TRUE,
                               facet_scale = "fixed",
                               manual_y_axis_title = "procent",
                               output_mapp = "",
                               filnamn_diagram = diagramfil,
                               skriv_till_diagramfil = FALSE)

```

```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 21"}
utb_bakgrund_fig
```

```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 23", include = FALSE}
#lista_figurer$befolkningsforandring_20_64
knitr::include_graphics(here("Diagram","utbildning_inriktning_kon.png"))
```

```{r, echo=FALSE, message = FALSE, warning = FALSE}
  diagram_capt <- "Källa: NMS-databasen (SCB), databasen Stativ\nBearbetning: Samhällsanalys, Region Dalarna"

  # Tittar på utbildning och bakgrund - diagram 2
 befolkning_alder_2064_df_sum <- befolkning_utb_alder_df %>%
   filter(SUN_old_namn %in% c("Förgymnasial utbildning kortare än 9 år","Förgymnasial utbildning 9 år")) %>% 
    group_by(year,Lan_namn,Kon_namn,bakgrund,alder_grupper) %>% 
      summarize(antal=sum(antal)) %>%
        mutate(andel=round((antal/sum(antal))*100,2)) 

  # Skapar en faktorvariabel för att få kön i "rätt" ordning i figuren
 befolkning_alder_2064_df_sum$Kon_namn <- factor(befolkning_alder_2064_df_sum$Kon_namn, levels = c("man","kvinna"))
            
  diagram_titel <- paste0("Personer (20-64 år) med förgymnasial utbildning i Dalarnas län ", unique(befolkning_alder_2064_df_sum$year))
  diagramfil <- "forgymnasial_alder_kon.png"
  
  forgym_alder_fig <- SkapaStapelDiagram(skickad_df = befolkning_alder_2064_df_sum,
                                         skickad_x_var = "alder_grupper",
                                         skickad_y_var = "antal",
                                         skickad_x_grupp = "Kon_namn",
                                         manual_color = diagramfarger("kon")[2:1],
                                         diagram_titel = diagram_titel,
                                         x_axis_lutning = 0,
                                         diagram_capt = diagram_capt,
                                         diagram_liggande = TRUE,
                                         legend_vand_ordning = TRUE,
                                         geom_position_stack = TRUE,
                                         stodlinjer_avrunda_fem = TRUE,
                                         manual_y_axis_title = "Antal personer",
                                         output_mapp = "",
                                         filnamn_diagram = diagramfil,
                                         skriv_till_diagramfil = FALSE)
```

```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 22"}
forgym_alder_fig
```

```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 23"}
#lista_figurer$befolkningsforandring_20_64
knitr::include_graphics(here("Diagram","tillg_eft_prognos_utbniva.png"))
```
<br>
<br>
<br>
```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 24"}
#lista_figurer$befolkningsforandring_20_64
knitr::include_graphics(here("Diagram","balans_tillg_eft_utbniva_prognos.png"))
```

### Gymnasiet, högskolan och YH
```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 27", include = FALSE}
#lista_figurer$befolkningsforandring_20_64
knitr::include_graphics(here("Diagram","gymnasieantagning_alla.png"))
```

```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 25"}
#lista_figurer$befolkningsforandring_20_64
knitr::include_graphics(here("Diagram","gymnasieantagning_alla_Peter.png"))
```
<br>
<br>
<br>
```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 26"}
#lista_figurer$befolkningsforandring_20_64
knitr::include_graphics(here("Diagram","gymnasieantagning_kon_Peter.png"))
```
<br>
<br>
<br>
```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 27"}
#lista_figurer$befolkningsforandring_20_64
knitr::include_graphics(here("Diagram","gymnasieantagning_fleraar_Peter.png"))
```
<br>
<br>
<br>
```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 28"}
#lista_figurer$befolkningsforandring_20_64
knitr::include_graphics(here("Diagram","gymnasieantagna_prognos.png"))
```
<br>
<br>
<br>
```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 29"}
#lista_figurer$befolkningsforandring_20_64
knitr::include_graphics(here("Diagram","hogskoleexamen_alla.png"))
```
<br>
<br>
<br>
```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 30"}
knitr::include_graphics(here("Diagram","hogskoleexamen_prognos.png"))
```
<br>
<br>
<br>
```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 31"}
knitr::include_graphics(here("Diagram","yh_bransch.png"))
```
<br>
<br>
<br>
```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 32"}
knitr::include_graphics(here("Diagram","yh_inriktning.png"))
```
<br>
<br>
<br>
```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 36", include = FALSE}
knitr::include_graphics(here("Diagram","yrkeshogskoleexamen_prognos.png"))
```
## 5 Matchning i Dalarnas län
<br>
<br>
<br>
```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 33"}
#lista_figurer$befolkningsforandring_20_64
knitr::include_graphics(here("Diagram","Sysselsättningsgrad_lan.png"))
```
<br>
<br>
<br>
```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 34"}
#lista_figurer$befolkningsforandring_20_64
knitr::include_graphics(here("Diagram","Sysselsättningsgrad_kommun.png"))
```
<br>
<br>
<br>
```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 35"}
#lista_figurer$befolkningsforandring_20_64
knitr::include_graphics(here("Diagram","matchning_lan.png"))
```
<br>
<br>
<br>
```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 36"}
#lista_figurer$befolkningsforandring_20_64
knitr::include_graphics(here("Diagram","matchning_bakgrund.png"))
```
<br>
<br>
<br>
```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 37"}
#lista_figurer$befolkningsforandring_20_64
knitr::include_graphics(here("Diagram","kompetensbrist.png"))
```

## 6 Utbildningsområden och prognoser
<br>
<br>
<br>
```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 38"}
#lista_figurer$befolkningsforandring_20_64
knitr::include_graphics(here("Diagram","_utbildningsgrupp_syss.png"))
```
<br>
<br>
<br>
```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 39"}
#lista_figurer$befolkningsforandring_20_64
knitr::include_graphics(here("Diagram","Andel_matchade_yrken_20-64 år_Dalarna53B_53R_55A_55C_55H.png"))
```
<br>
<br>
<br>
```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 40"}
#lista_figurer$befolkningsforandring_20_64
knitr::include_graphics(here("Diagram","_aldersniva_utb_grupp_bygg.png"))
```
<br>
<br>
<br>
```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 41"}
#lista_figurer$befolkningsforandring_20_64
knitr::include_graphics(here("Diagram","_konsfordelning_utb_grupp_bygg.png"))
```
<br>
<br>
<br>
```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 46", include = FALSE}
#lista_figurer$befolkningsforandring_20_64
knitr::include_graphics(here("Diagram","_utbildningsgrupp_flode.png"))
```
<br>
<br>
<br>
```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 42"}
#lista_figurer$befolkningsforandring_20_64
knitr::include_graphics(here("Diagram","balans_tillg_eft_prognos.png"))
```
<br>
<br>
<br>
```{r, echo=FALSE, fig.width=10, fig.align='Left',fig.cap="Figur 43"}
#lista_figurer$befolkningsforandring_20_64
knitr::include_graphics(here("Diagram","tillg_eft_prognos.png"))
```
